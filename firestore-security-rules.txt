rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    // Rules for the hunts collection
    match /hunts/{huntId} {
      // Allow users to read and write only their own hunts
      allow read, write: if request.auth != null && 
                            (resource == null || resource.data.userId == request.auth.uid);
      
      // Ensure the userId field matches the authenticated user when creating/updating
      allow create: if request.auth != null && 
                       request.resource.data.userId == request.auth.uid;
      
      allow update: if request.auth != null && 
                       resource.data.userId == request.auth.uid &&
                       request.resource.data.userId == request.auth.uid;
    }
    
    // For testing purposes - you can remove this later
    // This allows all authenticated users to read/write any document
    // match /{document=**} {
    //   allow read, write: if request.auth != null;
    // }
  }
}

/*
INSTRUCTIONS FOR FIREBASE CONSOLE:

1. Go to Firebase Console (console.firebase.google.com)
2. Select your project: fir-app-f0a08
3. Navigate to Firestore Database
4. Click on "Rules" tab
5. Replace the existing rules with the content above
6. Click "Publish" to save the rules

Alternative for testing (simpler but less secure):
If you want to allow all authenticated users to read/write for now, uncomment the last rule above.
*/